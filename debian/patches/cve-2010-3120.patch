description: fix cve-2010-3120
author: Michael Gilbert <michael.s.gilbert@gmail.com>
origin: http://trac.webkit.org/changeset/65329
Index: webkit/WebCore/page/Geolocation.cpp
===================================================================
--- webkit.orig/WebCore/page/Geolocation.cpp	2010-11-14 19:43:45.000000000 -0500
+++ webkit/WebCore/page/Geolocation.cpp	2010-11-14 19:44:04.000000000 -0500
@@ -256,6 +256,9 @@
 
 void Geolocation::getCurrentPosition(PassRefPtr<PositionCallback> successCallback, PassRefPtr<PositionErrorCallback> errorCallback, PassRefPtr<PositionOptions> options)
 {
+    if (!m_frame)
+        return;
+
     RefPtr<GeoNotifier> notifier = startRequest(successCallback, errorCallback, options);
     ASSERT(notifier);
 
@@ -264,6 +267,9 @@
 
 int Geolocation::watchPosition(PassRefPtr<PositionCallback> successCallback, PassRefPtr<PositionErrorCallback> errorCallback, PassRefPtr<PositionOptions> options)
 {
+    if (!m_frame)
+        return 0;
+
     RefPtr<GeoNotifier> notifier = startRequest(successCallback, errorCallback, options);
     ASSERT(notifier);
 
