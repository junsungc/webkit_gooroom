description: fix cve-2010-1762
author: Michael Gilbert <michael.s.gilbert@gmail.com>
origin: http://trac.webkit.org/changeset/59241
Index: webkit-1.2.1/WebCore/editing/markup.cpp
===================================================================
--- webkit-1.2.1.orig/WebCore/editing/markup.cpp	2010-05-13 16:31:30.000000000 -0400
+++ webkit-1.2.1/WebCore/editing/markup.cpp	2010-06-28 22:02:20.000000000 -0400
@@ -404,10 +404,12 @@
             if (Node* parent = node->parentNode()) {
                 if (parent->hasTagName(scriptTag)
                     || parent->hasTagName(styleTag)
-                    || parent->hasTagName(textareaTag)
                     || parent->hasTagName(xmpTag)) {
                     appendUCharRange(result, ucharRange(node, range));
                     break;
+                } else if (parent->hasTagName(textareaTag)) {
+                    appendEscapedContent(result, ucharRange(node, range), documentIsHTML);
+                    break;
                 }
             }
             if (!annotate) {
